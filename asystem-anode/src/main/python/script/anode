#!/bin/bash
#
# anode
#
# chkconfig:   <3,4,5> <start> <stop>
# description: ANode deamon
#
# # BEGIN INIT INFO
# Provides:          anode
# Required-Start:
# Required-Stop:
# Default-Start:     3 4 5
# Default-Stop:      0 1 6
# Short-Description: ANode
# Description:       ANode daemon
### END INIT INFO

ANODE=anode
ANODE_PATH=$(which anode)
ANODE_LOCK=/var/lock/subsys/${ANODE}
ANODE_FUNCTIONS=/etc/init.d/functions

if [ -f ${ANODE_FUNCTIONS} ]; then
  . ${ANODE_FUNCTIONS}
else
  echo "Unrecognised system [$(uname)], cannot start daemon"
  exit 1
fi

start() {
  initlog -c "echo -n Starting anode: "
  if [ ! -f ${ANODE_LOCK} ]; then
    nohup ${ANODE_PATH} -q > /dev/null &
    touch ${ANODE_LOCK}
    success $"anode started"
  else
    failure $"anode started"
  fi
  echo
}

stop() {
  initlog -c "echo -n Stopping anode: "
  killproc ${ANODE_PATH}
  rm -f ${ANODE_LOCK}
  success $"anode stopped"
  echo
}

status() {
  initlog -c "echo -n Status anode: "
  if [ -f ${ANODE_LOCK} ]; then
    success $"anode started"
  else
    failure $"anode stopped"
  fi
  echo
}

case "$1" in
  start)
    start
    ;;
  stop)
    stop
    ;;
  restart)
    stop
    start
    ;;
  status)
    status
    ;;
  *)
    echo $"Usage: $0 {start|stop|restart|status}"
    exit 1
esac

exit 0
